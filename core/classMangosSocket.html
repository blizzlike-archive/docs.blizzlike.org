<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>blizzlike core: MangosSocket&lt; SessionType, SocketName, Crypt &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">blizzlike core
   </div>
   <div id="projectbrief">mmorpg server</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classMangosSocket-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MangosSocket&lt; SessionType, SocketName, Crypt &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="MangosSocket_8h_source.html">MangosSocket.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MangosSocket&lt; SessionType, SocketName, Crypt &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMangosSocket.png" usemap="#MangosSocket_3C_20SessionType_2C_20SocketName_2C_20Crypt_20_3E_map" alt=""/>
  <map id="MangosSocket_3C_20SessionType_2C_20SocketName_2C_20Crypt_20_3E_map" name="MangosSocket_3C_20SessionType_2C_20SocketName_2C_20Crypt_20_3E_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a025cb155d5a6ce58b92d42f5f43d4206"><td class="memItemLeft" align="right" valign="top"><a id="a025cb155d5a6ce58b92d42f5f43d4206"></a>
typedef ACE_Acceptor&lt; SocketName, ACE_SOCK_ACCEPTOR &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a025cb155d5a6ce58b92d42f5f43d4206">Acceptor</a></td></tr>
<tr class="memdesc:a025cb155d5a6ce58b92d42f5f43d4206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare the acceptor for this class. <br /></td></tr>
<tr class="separator:a025cb155d5a6ce58b92d42f5f43d4206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab43c5336872e1f434ffe8676496d5a83"><td class="memItemLeft" align="right" valign="top"><a id="ab43c5336872e1f434ffe8676496d5a83"></a>
typedef ACE_Connector&lt; SocketName, ACE_SOCK_CONNECTOR &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>Connector</b></td></tr>
<tr class="separator:ab43c5336872e1f434ffe8676496d5a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee62754bf9004bb72289c3f9fd588d4"><td class="memItemLeft" align="right" valign="top"><a id="a6ee62754bf9004bb72289c3f9fd588d4"></a>
typedef ACE_Thread_Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a6ee62754bf9004bb72289c3f9fd588d4">LockType</a></td></tr>
<tr class="memdesc:a6ee62754bf9004bb72289c3f9fd588d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex type used for various synchronizations. <br /></td></tr>
<tr class="separator:a6ee62754bf9004bb72289c3f9fd588d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d2edd3fc6f3d123bd26cdf0ec55550"><td class="memItemLeft" align="right" valign="top"><a id="a03d2edd3fc6f3d123bd26cdf0ec55550"></a>
typedef ACE_Guard&lt; <a class="el" href="classMangosSocket.html#a6ee62754bf9004bb72289c3f9fd588d4">LockType</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>GuardType</b></td></tr>
<tr class="separator:a03d2edd3fc6f3d123bd26cdf0ec55550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20606ba506623b89f48f2b21849deaf2"><td class="memItemLeft" align="right" valign="top"><a id="a20606ba506623b89f48f2b21849deaf2"></a>
typedef ACE_Unbounded_Queue&lt; <a class="el" href="classWorldPacket.html">WorldPacket</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a20606ba506623b89f48f2b21849deaf2">PacketQueueT</a></td></tr>
<tr class="memdesc:a20606ba506623b89f48f2b21849deaf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue for storing packets for which there is no space. <br /></td></tr>
<tr class="separator:a20606ba506623b89f48f2b21849deaf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9ac9dd7ec08dc3eee634c3ab2d08ac31"><td class="memItemLeft" align="right" valign="top"><a id="a9ac9dd7ec08dc3eee634c3ab2d08ac31"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a9ac9dd7ec08dc3eee634c3ab2d08ac31">IsClosed</a> () const</td></tr>
<tr class="memdesc:a9ac9dd7ec08dc3eee634c3ab2d08ac31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if socket is closed. <br /></td></tr>
<tr class="separator:a9ac9dd7ec08dc3eee634c3ab2d08ac31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4aaa32dd56ad1c5ed7d561b205b6df"><td class="memItemLeft" align="right" valign="top"><a id="afe4aaa32dd56ad1c5ed7d561b205b6df"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#afe4aaa32dd56ad1c5ed7d561b205b6df">CloseSocket</a> (void)</td></tr>
<tr class="memdesc:afe4aaa32dd56ad1c5ed7d561b205b6df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the socket. <br /></td></tr>
<tr class="separator:afe4aaa32dd56ad1c5ed7d561b205b6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75c1b42aea7500b9367ff1f0bcecb7bf"><td class="memItemLeft" align="right" valign="top"><a id="a75c1b42aea7500b9367ff1f0bcecb7bf"></a>
const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a75c1b42aea7500b9367ff1f0bcecb7bf">GetRemoteAddress</a> () const</td></tr>
<tr class="memdesc:a75c1b42aea7500b9367ff1f0bcecb7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get address of connected peer. <br /></td></tr>
<tr class="separator:a75c1b42aea7500b9367ff1f0bcecb7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb36dd01fb841b354a0127b1de387221"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#adb36dd01fb841b354a0127b1de387221">SendPacket</a> (const <a class="el" href="classWorldPacket.html">WorldPacket</a> &amp;pct)</td></tr>
<tr class="separator:adb36dd01fb841b354a0127b1de387221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977e7239972ca94d456b74bf29929d79"><td class="memItemLeft" align="right" valign="top"><a id="a977e7239972ca94d456b74bf29929d79"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a977e7239972ca94d456b74bf29929d79">AddReference</a> ()</td></tr>
<tr class="memdesc:a977e7239972ca94d456b74bf29929d79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add reference to this object. <br /></td></tr>
<tr class="separator:a977e7239972ca94d456b74bf29929d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b715b47638b75a1d8e0f3d83dc98fa"><td class="memItemLeft" align="right" valign="top"><a id="a16b715b47638b75a1d8e0f3d83dc98fa"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a16b715b47638b75a1d8e0f3d83dc98fa">RemoveReference</a> ()</td></tr>
<tr class="memdesc:a16b715b47638b75a1d8e0f3d83dc98fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove reference to this object. <br /></td></tr>
<tr class="separator:a16b715b47638b75a1d8e0f3d83dc98fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96200cddd889d88378b438d73b70181a"><td class="memItemLeft" align="right" valign="top"><a id="a96200cddd889d88378b438d73b70181a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetSession</b> (SessionType *t)</td></tr>
<tr class="separator:a96200cddd889d88378b438d73b70181a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac3d4f5ed173d023183dbf867ba7d56"><td class="memItemLeft" align="right" valign="top"><a id="a7ac3d4f5ed173d023183dbf867ba7d56"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetClientSocket</b> ()</td></tr>
<tr class="separator:a7ac3d4f5ed173d023183dbf867ba7d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1ea80559d7b12623a874d0a6f74c600"><td class="memItemLeft" align="right" valign="top"><a id="af1ea80559d7b12623a874d0a6f74c600"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#af1ea80559d7b12623a874d0a6f74c600">IsServerSide</a> ()</td></tr>
<tr class="memdesc:af1ea80559d7b12623a874d0a6f74c600"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true iif the socket is connected TO a client (ie we are the server) <br /></td></tr>
<tr class="separator:af1ea80559d7b12623a874d0a6f74c600"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad8165a01d7b5f54f4faea7959d8607e6"><td class="memItemLeft" align="right" valign="top"><a id="ad8165a01d7b5f54f4faea7959d8607e6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#ad8165a01d7b5f54f4faea7959d8607e6">MangosSocket</a> ()</td></tr>
<tr class="memdesc:ad8165a01d7b5f54f4faea7959d8607e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">things called by ACE framework. <br /></td></tr>
<tr class="separator:ad8165a01d7b5f54f4faea7959d8607e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa61fe85b09bfb60b58461fba8ddafda"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#aaa61fe85b09bfb60b58461fba8ddafda">ProcessIncoming</a> (<a class="el" href="classWorldPacket.html">WorldPacket</a> *new_pct)</td></tr>
<tr class="separator:aaa61fe85b09bfb60b58461fba8ddafda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0783a94965058cac035d2fe77da56c8b"><td class="memItemLeft" align="right" valign="top"><a id="a0783a94965058cac035d2fe77da56c8b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>OnSocketOpen</b> ()</td></tr>
<tr class="separator:a0783a94965058cac035d2fe77da56c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8fe84e611df513052f6678218cc559f"><td class="memItemLeft" align="right" valign="top"><a id="af8fe84e611df513052f6678218cc559f"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#af8fe84e611df513052f6678218cc559f">open</a> (void *)</td></tr>
<tr class="memdesc:af8fe84e611df513052f6678218cc559f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called on open ,the void* is the acceptor. <br /></td></tr>
<tr class="separator:af8fe84e611df513052f6678218cc559f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2f2f0c4fd3b08111043e8c0b30a23e"><td class="memItemLeft" align="right" valign="top"><a id="a0a2f2f0c4fd3b08111043e8c0b30a23e"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a0a2f2f0c4fd3b08111043e8c0b30a23e">close</a> (int)</td></tr>
<tr class="memdesc:a0a2f2f0c4fd3b08111043e8c0b30a23e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called on failures inside of the acceptor, don't call from your code. <br /></td></tr>
<tr class="separator:a0a2f2f0c4fd3b08111043e8c0b30a23e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add46d85b084f43ec37f33c0ba55fa3f5"><td class="memItemLeft" align="right" valign="top"><a id="add46d85b084f43ec37f33c0ba55fa3f5"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#add46d85b084f43ec37f33c0ba55fa3f5">handle_input</a> (ACE_HANDLE=ACE_INVALID_HANDLE)</td></tr>
<tr class="memdesc:add46d85b084f43ec37f33c0ba55fa3f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when we can read from the socket. <br /></td></tr>
<tr class="separator:add46d85b084f43ec37f33c0ba55fa3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a2c807b481cdc980c1ff66b950b355"><td class="memItemLeft" align="right" valign="top"><a id="a22a2c807b481cdc980c1ff66b950b355"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a22a2c807b481cdc980c1ff66b950b355">handle_output</a> (ACE_HANDLE=ACE_INVALID_HANDLE)</td></tr>
<tr class="memdesc:a22a2c807b481cdc980c1ff66b950b355"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the socket can write. <br /></td></tr>
<tr class="separator:a22a2c807b481cdc980c1ff66b950b355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88de3c1f5ee620aab82c7e1dac4f628"><td class="memItemLeft" align="right" valign="top"><a id="af88de3c1f5ee620aab82c7e1dac4f628"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#af88de3c1f5ee620aab82c7e1dac4f628">handle_close</a> (ACE_HANDLE=ACE_INVALID_HANDLE, ACE_Reactor_Mask=ACE_Event_Handler::ALL_EVENTS_MASK)</td></tr>
<tr class="memdesc:af88de3c1f5ee620aab82c7e1dac4f628"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when connection is closed or error happens. <br /></td></tr>
<tr class="separator:af88de3c1f5ee620aab82c7e1dac4f628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd087632f1de6c3f32f95a403f9122e7"><td class="memItemLeft" align="right" valign="top"><a id="afd087632f1de6c3f32f95a403f9122e7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#afd087632f1de6c3f32f95a403f9122e7">Update</a> (void)</td></tr>
<tr class="memdesc:afd087632f1de6c3f32f95a403f9122e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by WorldSocketMgr/ReactorRunnable. <br /></td></tr>
<tr class="separator:afd087632f1de6c3f32f95a403f9122e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2934fe9b40ba6ad70dbdb42e79b63f27"><td class="memItemLeft" align="right" valign="top"><a id="a2934fe9b40ba6ad70dbdb42e79b63f27"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a2934fe9b40ba6ad70dbdb42e79b63f27">handle_input_header</a> (void)</td></tr>
<tr class="memdesc:a2934fe9b40ba6ad70dbdb42e79b63f27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper functions for processing incoming data. <br /></td></tr>
<tr class="separator:a2934fe9b40ba6ad70dbdb42e79b63f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d50e68b89a0fa7f137d7ffd15d3430"><td class="memItemLeft" align="right" valign="top"><a id="ab5d50e68b89a0fa7f137d7ffd15d3430"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>handle_input_payload</b> (void)</td></tr>
<tr class="separator:ab5d50e68b89a0fa7f137d7ffd15d3430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a465f0617a1c30025fa0780ee05e50b32"><td class="memItemLeft" align="right" valign="top"><a id="a465f0617a1c30025fa0780ee05e50b32"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>handle_input_missing_data</b> (void)</td></tr>
<tr class="separator:a465f0617a1c30025fa0780ee05e50b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e99c55a9bef0db58f114400e1ea3507"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a0e99c55a9bef0db58f114400e1ea3507">cancel_wakeup_output</a> (GuardType &amp;g)</td></tr>
<tr class="separator:a0e99c55a9bef0db58f114400e1ea3507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af66302aabff9372cb5a21af07403f5c0"><td class="memItemLeft" align="right" valign="top"><a id="af66302aabff9372cb5a21af07403f5c0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_wakeup_output</b> (GuardType &amp;g)</td></tr>
<tr class="separator:af66302aabff9372cb5a21af07403f5c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044b5c458b5c0feea77d49ebc35a0bd0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a044b5c458b5c0feea77d49ebc35a0bd0">iSendPacket</a> (const <a class="el" href="classWorldPacket.html">WorldPacket</a> &amp;pct)</td></tr>
<tr class="separator:a044b5c458b5c0feea77d49ebc35a0bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf00d56092c8a6428a9948306cdb1cc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#aacf00d56092c8a6428a9948306cdb1cc">iFlushPacketQueue</a> ()</td></tr>
<tr class="separator:aacf00d56092c8a6428a9948306cdb1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6615d0eff350e92a453a92a178b00033"><td class="memItemLeft" align="right" valign="top"><a id="a6615d0eff350e92a453a92a178b00033"></a>
ACE_Time_Value&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a6615d0eff350e92a453a92a178b00033">m_LastPingTime</a></td></tr>
<tr class="memdesc:a6615d0eff350e92a453a92a178b00033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time in which the last ping was received. <br /></td></tr>
<tr class="separator:a6615d0eff350e92a453a92a178b00033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2547ad3866937e017c062b24c5d358cc"><td class="memItemLeft" align="right" valign="top"><a id="a2547ad3866937e017c062b24c5d358cc"></a>
uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a2547ad3866937e017c062b24c5d358cc">m_OverSpeedPings</a></td></tr>
<tr class="memdesc:a2547ad3866937e017c062b24c5d358cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep track of over-speed pings ,to prevent ping flood. <br /></td></tr>
<tr class="separator:a2547ad3866937e017c062b24c5d358cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f2a9cdce2a9b6064b9b0b9053e275b"><td class="memItemLeft" align="right" valign="top"><a id="aa9f2a9cdce2a9b6064b9b0b9053e275b"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#aa9f2a9cdce2a9b6064b9b0b9053e275b">m_Address</a></td></tr>
<tr class="memdesc:aa9f2a9cdce2a9b6064b9b0b9053e275b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Address of the remote peer. <br /></td></tr>
<tr class="separator:aa9f2a9cdce2a9b6064b9b0b9053e275b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f8885cebb3e05b81939a31dd257eed5"><td class="memItemLeft" align="right" valign="top"><a id="a0f8885cebb3e05b81939a31dd257eed5"></a>
Crypt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a0f8885cebb3e05b81939a31dd257eed5">m_Crypt</a></td></tr>
<tr class="memdesc:a0f8885cebb3e05b81939a31dd257eed5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class used for managing encryption of the headers. <br /></td></tr>
<tr class="separator:a0f8885cebb3e05b81939a31dd257eed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe2ef1884d52ef0b348d5c2959eccf1"><td class="memItemLeft" align="right" valign="top"><a id="a3fe2ef1884d52ef0b348d5c2959eccf1"></a>
<a class="el" href="classMangosSocket.html#a6ee62754bf9004bb72289c3f9fd588d4">LockType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a3fe2ef1884d52ef0b348d5c2959eccf1">m_SessionLock</a></td></tr>
<tr class="memdesc:a3fe2ef1884d52ef0b348d5c2959eccf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex lock to protect m_Session. <br /></td></tr>
<tr class="separator:a3fe2ef1884d52ef0b348d5c2959eccf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a579e5c9debc5efb32c8782d141a2e015"><td class="memItemLeft" align="right" valign="top"><a id="a579e5c9debc5efb32c8782d141a2e015"></a>
SessionType *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a579e5c9debc5efb32c8782d141a2e015">m_Session</a></td></tr>
<tr class="memdesc:a579e5c9debc5efb32c8782d141a2e015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Session to which received packets are routed. <br /></td></tr>
<tr class="separator:a579e5c9debc5efb32c8782d141a2e015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a786043119180186b7e1c966c3e1f08f1"><td class="memItemLeft" align="right" valign="top"><a id="a786043119180186b7e1c966c3e1f08f1"></a>
<a class="el" href="classWorldPacket.html">WorldPacket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a786043119180186b7e1c966c3e1f08f1">m_RecvWPct</a></td></tr>
<tr class="memdesc:a786043119180186b7e1c966c3e1f08f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">here are stored the fragments of the received data <br /></td></tr>
<tr class="separator:a786043119180186b7e1c966c3e1f08f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c828f926d17c4736bc5ca011771b6f"><td class="memItemLeft" align="right" valign="top">ACE_Message_Block&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a34c828f926d17c4736bc5ca011771b6f">m_RecvPct</a></td></tr>
<tr class="separator:a34c828f926d17c4736bc5ca011771b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac493a33e24e74dd874bcb2a96846fb9e"><td class="memItemLeft" align="right" valign="top"><a id="ac493a33e24e74dd874bcb2a96846fb9e"></a>
ACE_Message_Block&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#ac493a33e24e74dd874bcb2a96846fb9e">m_Header</a></td></tr>
<tr class="memdesc:ac493a33e24e74dd874bcb2a96846fb9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragment of the received header. <br /></td></tr>
<tr class="separator:ac493a33e24e74dd874bcb2a96846fb9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c1b27ebef2cbce47e80c6e2d35b890"><td class="memItemLeft" align="right" valign="top"><a id="af6c1b27ebef2cbce47e80c6e2d35b890"></a>
<a class="el" href="classMangosSocket.html#a6ee62754bf9004bb72289c3f9fd588d4">LockType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#af6c1b27ebef2cbce47e80c6e2d35b890">m_OutBufferLock</a></td></tr>
<tr class="memdesc:af6c1b27ebef2cbce47e80c6e2d35b890"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for protecting output related data. <br /></td></tr>
<tr class="separator:af6c1b27ebef2cbce47e80c6e2d35b890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d525a9b5e7d3818f7f5aa6f7e50ec5e"><td class="memItemLeft" align="right" valign="top"><a id="a8d525a9b5e7d3818f7f5aa6f7e50ec5e"></a>
ACE_Message_Block *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a8d525a9b5e7d3818f7f5aa6f7e50ec5e">m_OutBuffer</a></td></tr>
<tr class="memdesc:a8d525a9b5e7d3818f7f5aa6f7e50ec5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer used for writing output. <br /></td></tr>
<tr class="separator:a8d525a9b5e7d3818f7f5aa6f7e50ec5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7e58192a823b99d785d0f6cc342d2d"><td class="memItemLeft" align="right" valign="top"><a id="a6c7e58192a823b99d785d0f6cc342d2d"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a6c7e58192a823b99d785d0f6cc342d2d">m_OutBufferSize</a></td></tr>
<tr class="memdesc:a6c7e58192a823b99d785d0f6cc342d2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the m_OutBuffer. <br /></td></tr>
<tr class="separator:a6c7e58192a823b99d785d0f6cc342d2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ddd17bbcab003fef3c88ec5e5d24e76"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMangosSocket.html#a20606ba506623b89f48f2b21849deaf2">PacketQueueT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a7ddd17bbcab003fef3c88ec5e5d24e76">m_PacketQueue</a></td></tr>
<tr class="separator:a7ddd17bbcab003fef3c88ec5e5d24e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9425aa70aa02995a8a9c3b01a71102"><td class="memItemLeft" align="right" valign="top"><a id="aff9425aa70aa02995a8a9c3b01a71102"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#aff9425aa70aa02995a8a9c3b01a71102">m_OutActive</a></td></tr>
<tr class="memdesc:aff9425aa70aa02995a8a9c3b01a71102"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the socket is registered with the reactor for output. <br /></td></tr>
<tr class="separator:aff9425aa70aa02995a8a9c3b01a71102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a861ae0339f96dc4a5dd709f2b28f697b"><td class="memItemLeft" align="right" valign="top"><a id="a861ae0339f96dc4a5dd709f2b28f697b"></a>
uint32&#160;</td><td class="memItemRight" valign="bottom"><b>m_Seed</b></td></tr>
<tr class="separator:a861ae0339f96dc4a5dd709f2b28f697b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28e3993deee74c66be16363c298d7f7"><td class="memItemLeft" align="right" valign="top"><a id="ab28e3993deee74c66be16363c298d7f7"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>m_isServerSocket</b></td></tr>
<tr class="separator:ab28e3993deee74c66be16363c298d7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a2df7c27043843b90e0454b4a14f7261e"><td class="memItemLeft" align="right" valign="top"><a id="a2df7c27043843b90e0454b4a14f7261e"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMangosSocket.html#a2df7c27043843b90e0454b4a14f7261e">ACE_Acceptor&lt; SocketName, ACE_SOCK_ACCEPTOR &gt;</a></td></tr>
<tr class="memdesc:a2df7c27043843b90e0454b4a14f7261e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare some friends. <br /></td></tr>
<tr class="separator:a2df7c27043843b90e0454b4a14f7261e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab40f5fbd514495be02d122e0e8d78347"><td class="memItemLeft" align="right" valign="top"><a id="ab40f5fbd514495be02d122e0e8d78347"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>ACE_Connector&lt; SocketName, ACE_SOCK_CONNECTOR &gt;</b></td></tr>
<tr class="separator:ab40f5fbd514495be02d122e0e8d78347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac671e63545496da24a9ece5850e4fe33"><td class="memItemLeft" align="right" valign="top"><a id="ac671e63545496da24a9ece5850e4fe33"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>ACE_NonBlocking_Connect_Handler&lt; SocketName &gt;</b></td></tr>
<tr class="separator:ac671e63545496da24a9ece5850e4fe33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename SessionType, typename SocketName, typename Crypt&gt;<br />
class MangosSocket&lt; SessionType, SocketName, Crypt &gt;</h3>

<p><a class="el" href="classMangosSocket.html">MangosSocket</a>.</p>
<p>This class is responsible for the communication with remote clients. Most methods return -1 on failure. The class uses reference counting.</p>
<p>For output the class uses one buffer (64K usually) and a queue where it stores packet if there is no place on the queue. The reason this is done, is because the server does really a lot of small-size writes to it, and it doesn't scale well to allocate memory for every. When something is written to the output buffer the socket is not immediately activated for output (again for the same reason), there is 10ms celling (thats why there is <a class="el" href="classMangosSocket.html#afd087632f1de6c3f32f95a403f9122e7" title="Called by WorldSocketMgr/ReactorRunnable. ">Update()</a> method). This concept is similar to TCP_CORK, but TCP_CORK uses 200ms celling. As result overhead generated by sending packets from "producer" threads is minimal, and doing a lot of writes with small size is tolerated.</p>
<p>The calls to Update () method are managed by <a class="el" href="classWorldSocketMgr.html" title="Manages all sockets connected to peers and network threads. ">WorldSocketMgr</a> and <a class="el" href="classReactorRunnable.html">ReactorRunnable</a>.</p>
<p>For input ,the class uses one 1024 bytes buffer on stack to which it does recv() calls. And then received data is distributed where its needed. 1024 matches pretty well the traffic generated by client for now.</p>
<p>The input/output do speculative reads/writes (AKA it tryes to read all data available in the kernel buffer or tryes to write everything available in userspace buffer), which is ok for using with Level and Edge Triggered IO notification. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0e99c55a9bef0db58f114400e1ea3507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e99c55a9bef0db58f114400e1ea3507">&#9670;&nbsp;</a></span>cancel_wakeup_output()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType , typename SocketName , typename Crypt &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::cancel_wakeup_output </td>
          <td>(</td>
          <td class="paramtype">GuardType &amp;&#160;</td>
          <td class="paramname"><em>g</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Help functions to mark/unmark the socket for output. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>the guard is for m_OutBufferLock, the function will release it </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aacf00d56092c8a6428a9948306cdb1cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf00d56092c8a6428a9948306cdb1cc">&#9670;&nbsp;</a></span>iFlushPacketQueue()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType , typename SocketName , typename Crypt &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::iFlushPacketQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flush m_PacketQueue if there are packets in it Need to be called with m_OutBufferLock lock held </p><dl class="section return"><dt>Returns</dt><dd>true if it wrote to the buffer ( AKA you need to mark the socket for output ). </dd></dl>

</div>
</div>
<a id="a044b5c458b5c0feea77d49ebc35a0bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044b5c458b5c0feea77d49ebc35a0bd0">&#9670;&nbsp;</a></span>iSendPacket()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType , typename SocketName , typename Crypt &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::iSendPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWorldPacket.html">WorldPacket</a> &amp;&#160;</td>
          <td class="paramname"><em>pct</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Try to write <a class="el" href="classWorldPacket.html">WorldPacket</a> to m_OutBuffer ,return -1 if no space Need to be called with m_OutBufferLock lock held </p>

</div>
</div>
<a id="aaa61fe85b09bfb60b58461fba8ddafda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa61fe85b09bfb60b58461fba8ddafda">&#9670;&nbsp;</a></span>ProcessIncoming()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType, typename SocketName, typename Crypt&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::ProcessIncoming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorldPacket.html">WorldPacket</a> *&#160;</td>
          <td class="paramname"><em>new_pct</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>process one incoming packet. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_pct</td><td>received packet ,note that you need to delete it. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adb36dd01fb841b354a0127b1de387221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb36dd01fb841b354a0127b1de387221">&#9670;&nbsp;</a></span>SendPacket()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType , typename SocketName , typename Crypt &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::SendPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWorldPacket.html">WorldPacket</a> &amp;&#160;</td>
          <td class="paramname"><em>pct</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send A packet on the socket, this function is reentrant. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pct</td><td>packet to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 of failure </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7ddd17bbcab003fef3c88ec5e5d24e76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ddd17bbcab003fef3c88ec5e5d24e76">&#9670;&nbsp;</a></span>m_PacketQueue</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType, typename SocketName, typename Crypt&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMangosSocket.html#a20606ba506623b89f48f2b21849deaf2">PacketQueueT</a> <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::m_PacketQueue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Here are stored packets for which there was no space on m_OutBuffer, this allows not-to kick player if its buffer is overflowed. </p>

</div>
</div>
<a id="a34c828f926d17c4736bc5ca011771b6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34c828f926d17c4736bc5ca011771b6f">&#9670;&nbsp;</a></span>m_RecvPct</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SessionType, typename SocketName, typename Crypt&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ACE_Message_Block <a class="el" href="classMangosSocket.html">MangosSocket</a>&lt; SessionType, SocketName, Crypt &gt;::m_RecvPct</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This block actually refers to m_RecvWPct contents, which allows easy and safe writing to it. It wont free memory when its deleted. m_RecvWPct takes care of freeing. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/framework/Network/<a class="el" href="MangosSocket_8h_source.html">MangosSocket.h</a></li>
<li>src/framework/Network/<a class="el" href="MangosSocketImpl_8h_source.html">MangosSocketImpl.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
